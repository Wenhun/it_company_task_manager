{% extends 'base.html' %}
{% load static %}
{% load task_type_image_changer %}

{% block content %}
  <!-- Header -->
  <header class="w3-container " style="padding-top:22px">
    <h5><b>My task statistic</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom">
    <div class="w3-quarter">
      <div class="w3-container w3-red w3-padding-16">
        <div class="w3-left"><img src="{% static 'images/tasks_all.svg' %}" alt="tasks-all" style="width:56px;height:56px;"></div>
        <div class="w3-right">
          <h3>{{ tasks.all.count }}</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>All tasks owned</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left"><img src="{% static 'images/tasks_progress.svg' %}" alt="tasks-progress" style="width:56px;height:56px;"></div>
        <div class="w3-right">
          <h3>{{ num_not_completed_tasks }}</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Tasks in progress</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-teal w3-padding-16">
        <div class="w3-left"><img src="{% static 'images/tasks-completed.svg' %}" alt="tasks-completed" style="width:56px;height:56px;"></div>
        <div class="w3-right">
          <h3>{{ num_completed_tasks }}</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Completed tasks</h4>
      </div>
    </div>
  </div>

  <div class="w3-container">
    <h5>Current project</h5>
    <div class="w3-button">
      <img src="{% static 'images/project.svg' %}" alt="logout" style="width:18px;height:18px;">
      <a href="{% url 'task_manager:project-detail' pk=project.id %}">
        <b>{{ project.project_name }}</b>
      </a>
    </div>
    <div class="w3-grey">
      <div class="w3-container w3-center w3-padding w3-green" style="width:25%">Completed: NUM_COMPLETED / NUM_ALL </div>
    </div>
  </div>
  <hr>

  <div class="w3-panel">
    <div class="w3-row-padding" style="margin:0 -16px">
      <div class="w3-twothird">
        <h5>Current tasks</h5>
        <table class="w3-table w3-striped w3-white" >
          {% for task in tasks|slice:":10" %}
              {% if not task.is_completed %}
              <tr class="w3-hover-blue" onclick="location.href='{% url "task_manager:task-detail" pk=task.id %}';" style="cursor: pointer;">
                  <td><img src="{% static task.task_type.name|task_image %}" alt="{{ task.task_type.name }}" style="width:18px;height:18px;"></td>
                  <td>{{ task.name }}</td>
                  <td>
                    <i>
                      Deadline: {{ task.deadline }}
                      {% if task.deadline < current_date %}
                        <div style="color: red">OVERDUE!</div>
                      {% endif %}
                    </i>
                  </td>
                  <td><i>Priority: {{ task.get_priority_display }}</i></td>
              </tr>
              {% endif %}
            {% empty %}
            You have no tasks!
          {% endfor %}
        </table>
      </div>
    </div>
  </div>
  <hr>

  <div class="w3-container">
    <h5>My team:</h5>
    {% for worker in team_workers%}
    <ul class="w3-ul w3-card-4 w3-white">
        <li class="w3-padding-16">
        <img src={% static 'images/worker-cart.svg' %} class="w3-left w3-circle w3-margin-right" style="width:35px">
        <span class="w3-xlarge">{{ worker.username }}</span><br>
      </li>
    </ul>
      {% empty %}
      <h3>You alone in this team :(</h3>
      {% endfor %}
  </div>
  <hr>
{% endblock %}